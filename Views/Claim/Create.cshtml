@model CMCSWeb.Models.Claim
@{
    ViewData["Title"] = "Submit Claim";
}

<h2>Submit Your Claim</h2>

@if (ViewBag.Message != null)
{
    <div class="alert alert-success">
        @ViewBag.Message
    </div>
}

<form asp-action="Create" method="post" enctype="multipart/form-data">
    <!-- REMOVED LecturerName field - it will be auto-populated from the logged-in user -->
    
    <div class="mb-3">
        <label asp-for="HoursWorked" class="form-label">Hours Worked *</label>
        <input asp-for="HoursWorked" class="form-control" type="number" step="0.1" min="0.1" max="180" />
        <span asp-validation-for="HoursWorked" class="text-danger"></span>
        <small class="form-text text-muted">Maximum 180 hours per month</small>
    </div>

    <div class="mb-3">
        <label asp-for="HourlyRate" class="form-label">Hourly Rate (R) *</label>
        <input asp-for="HourlyRate" class="form-control" type="number" step="0.01" min="0.1" />
        <span asp-validation-for="HourlyRate" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label class="form-label">Total Amount</label>
        <input type="text" class="form-control" id="totalAmount" readonly value="R 0.00" />
        <small class="form-text text-muted">Auto-calculated: Hours × Rate</small>
    </div>

    <div class="mb-3">
        <label asp-for="Notes" class="form-label">Notes</label>
        <textarea asp-for="Notes" class="form-control" rows="3" placeholder="Enter any additional notes or description of work..."></textarea>
        <span asp-validation-for="Notes" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label class="form-label">Upload Document (Optional)</label>
        <input type="file" name="document" class="form-control" accept=".pdf,.docx,.xlsx,.jpg,.jpeg" />
        <small class="form-text text-muted">Allowed formats: PDF, Word, Excel, JPEG (Max: 5MB)</small>
    </div>

    <button type="submit" class="btn btn-primary">Submit Claim</button>
    <a asp-action="Status" class="btn btn-secondary">View My Claims</a>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        function calculateTotal() {
            const hours = parseFloat(document.getElementById('HoursWorked').value) || 0;
            const rate = parseFloat(document.getElementById('HourlyRate').value) || 0;
            const total = hours * rate;
            document.getElementById('totalAmount').value = 'R ' + total.toFixed(2);
        }

        // Add event listeners for auto-calculation
        document.getElementById('HoursWorked').addEventListener('input', calculateTotal);
        document.getElementById('HourlyRate').addEventListener('input', calculateTotal);

        // Calculate on page load
        document.addEventListener('DOMContentLoaded', calculateTotal);
    </script>
}